/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
[rank0]: Traceback (most recent call last):
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/urllib3/connection.py", line 196, in _new_conn
[rank0]:     sock = connection.create_connection(
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/urllib3/util/connection.py", line 60, in create_connection
[rank0]:     for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/socket.py", line 955, in getaddrinfo
[rank0]:     for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
[rank0]: socket.gaierror: [Errno -2] Name or service not known

[rank0]: The above exception was the direct cause of the following exception:

[rank0]: Traceback (most recent call last):
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/urllib3/connectionpool.py", line 789, in urlopen
[rank0]:     response = self._make_request(
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/urllib3/connectionpool.py", line 490, in _make_request
[rank0]:     raise new_e
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/urllib3/connectionpool.py", line 466, in _make_request
[rank0]:     self._validate_conn(conn)
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1095, in _validate_conn
[rank0]:     conn.connect()
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/urllib3/connection.py", line 615, in connect
[rank0]:     self.sock = sock = self._new_conn()
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/urllib3/connection.py", line 203, in _new_conn
[rank0]:     raise NameResolutionError(self.host, self, e) from e
[rank0]: urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPSConnection object at 0x1527d0817850>: Failed to resolve 'huggingface.co' ([Errno -2] Name or service not known)

[rank0]: The above exception was the direct cause of the following exception:

[rank0]: Traceback (most recent call last):
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/requests/adapters.py", line 667, in send
[rank0]:     resp = conn.urlopen(
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/urllib3/connectionpool.py", line 843, in urlopen
[rank0]:     retries = retries.increment(
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
[rank0]:     raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
[rank0]: urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /api/models/ao9000/gpt2-cda-race (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x1527d0817850>: Failed to resolve 'huggingface.co' ([Errno -2] Name or service not known)"))

[rank0]: During handling of the above exception, another exception occurred:

[rank0]: Traceback (most recent call last):
[rank0]:   File "/dccstor/autofair/busekorkmaz/factual-bias-mitigation/scripts/mmlu/evaluate_vllm.py", line 344, in <module>
[rank0]:     main()
[rank0]:   File "/dccstor/autofair/busekorkmaz/factual-bias-mitigation/scripts/mmlu/evaluate_vllm.py", line 258, in main
[rank0]:     model, tokenizer = load_model(model_name)
[rank0]:   File "/dccstor/autofair/busekorkmaz/factual-bias-mitigation/scripts/mmlu/evaluate_vllm.py", line 52, in load_model
[rank0]:     llm = LLM(model=model_name, gpu_memory_utilization=float(args.gpu_util),
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/vllm/entrypoints/llm.py", line 123, in __init__
[rank0]:     self.llm_engine = LLMEngine.from_engine_args(
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/vllm/engine/llm_engine.py", line 292, in from_engine_args
[rank0]:     engine = cls(
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/vllm/engine/llm_engine.py", line 160, in __init__
[rank0]:     self.model_executor = executor_class(
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/vllm/executor/executor_base.py", line 41, in __init__
[rank0]:     self._init_executor()
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/vllm/executor/gpu_executor.py", line 23, in _init_executor
[rank0]:     self._init_non_spec_worker()
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/vllm/executor/gpu_executor.py", line 69, in _init_non_spec_worker
[rank0]:     self.driver_worker.load_model()
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/vllm/worker/worker.py", line 118, in load_model
[rank0]:     self.model_runner.load_model()
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/vllm/worker/model_runner.py", line 164, in load_model
[rank0]:     self.model = get_model(
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/vllm/model_executor/model_loader/__init__.py", line 19, in get_model
[rank0]:     return loader.load_model(model_config=model_config,
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/vllm/model_executor/model_loader/loader.py", line 225, in load_model
[rank0]:     self._get_weights_iterator(model_config.model,
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/vllm/model_executor/model_loader/loader.py", line 202, in _get_weights_iterator
[rank0]:     hf_folder, hf_weights_files, use_safetensors = self._prepare_weights(
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/vllm/model_executor/model_loader/loader.py", line 173, in _prepare_weights
[rank0]:     hf_folder = download_weights_from_hf(model_name_or_path,
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/vllm/model_executor/model_loader/weight_utils.py", line 190, in download_weights_from_hf
[rank0]:     file_list = fs.ls(model_name_or_path, detail=False, revision=revision)
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/huggingface_hub/hf_file_system.py", line 288, in ls
[rank0]:     resolved_path = self.resolve_path(path, revision=revision)
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/huggingface_hub/hf_file_system.py", line 194, in resolve_path
[rank0]:     repo_and_revision_exist, err = self._repo_and_revision_exist(repo_type, repo_id, revision)
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/huggingface_hub/hf_file_system.py", line 131, in _repo_and_revision_exist
[rank0]:     self._api.repo_info(repo_id, revision=revision, repo_type=repo_type, timeout=HF_HUB_ETAG_TIMEOUT)
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
[rank0]:     return fn(*args, **kwargs)
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/huggingface_hub/hf_api.py", line 2588, in repo_info
[rank0]:     return method(
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
[rank0]:     return fn(*args, **kwargs)
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/huggingface_hub/hf_api.py", line 2372, in model_info
[rank0]:     r = get_session().get(path, headers=headers, timeout=timeout, params=params)
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/requests/sessions.py", line 602, in get
[rank0]:     return self.request("GET", url, **kwargs)
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
[rank0]:     resp = self.send(prep, **send_kwargs)
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
[rank0]:     r = adapter.send(request, **kwargs)
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/huggingface_hub/utils/_http.py", line 66, in send
[rank0]:     return super().send(request, *args, **kwargs)
[rank0]:   File "/dccstor/autofair/busekorkmaz/mmlu_pro/lib/python3.10/site-packages/requests/adapters.py", line 700, in send
[rank0]:     raise ConnectionError(e, request=request)
[rank0]: requests.exceptions.ConnectionError: (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /api/models/ao9000/gpt2-cda-race (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x1527d0817850>: Failed to resolve \'huggingface.co\' ([Errno -2] Name or service not known)"))'), '(Request ID: 6a2c0f8e-657d-4d7f-9946-53bef6dc7d7e)')
